'use strict';

exports.__esModule = true;
exports.isCommandRejectableByPageError = isCommandRejectableByPageError;
exports.canSetDebuggerBreakpointBeforeCommand = canSetDebuggerBreakpointBeforeCommand;
exports.isScreenshotCommand = isScreenshotCommand;
exports.isResizeWindowCommand = isResizeWindowCommand;
exports.isBrowserManipulationCommand = isBrowserManipulationCommand;
exports.isServiceCommand = isServiceCommand;
exports.isExecutableInTopWindowOnly = isExecutableInTopWindowOnly;
exports.isJSExpression = isJSExpression;
exports.isExecutableOnClientCommand = isExecutableOnClientCommand;

var _type = require('./type');

var _type2 = _interopRequireDefault(_type);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const RAW_API_JS_EXPRESSION_TYPE = 'js-expr'; // -------------------------------------------------------------
// WARNING: this file is used by both the client and the server.
// Do not use any browser or node-specific API!
// -------------------------------------------------------------
function isCommandRejectableByPageError(command) {
    return !isObservationCommand(command) && !isBrowserManipulationCommand(command) && !isServiceCommand(command) || isResizeWindowCommand(command) && !isWindowSwitchingCommand(command);
}

function isClientFunctionCommand(command) {
    return command.type === _type2.default.executeClientFunction || command.type === _type2.default.executeSelector;
}

function isObservationCommand(command) {
    return isClientFunctionCommand(command) || command.type === _type2.default.wait || command.type === _type2.default.assertion || command.type === _type2.default.executeExpression;
}

function isWindowSwitchingCommand(command) {
    return command.type === _type2.default.switchToIframe || command.type === _type2.default.switchToMainWindow;
}

function canSetDebuggerBreakpointBeforeCommand(command) {
    return command.type !== _type2.default.debug && !isClientFunctionCommand(command) && !isServiceCommand(command);
}

function isScreenshotCommand(command) {
    return command.type === _type2.default.takeScreenshot || command.type === _type2.default.takeElementScreenshot || command.type === _type2.default.takeScreenshotOnFail;
}

function isResizeWindowCommand(command) {
    return command.type === _type2.default.resizeWindow || command.type === _type2.default.resizeWindowToFitDevice || command.type === _type2.default.maximizeWindow;
}

function isBrowserManipulationCommand(command) {
    return isScreenshotCommand(command) || isResizeWindowCommand(command);
}

function isServiceCommand(command) {
    return command.type === _type2.default.testDone || command.type === _type2.default.showAssertionRetriesStatus || command.type === _type2.default.hideAssertionRetriesStatus || command.type === _type2.default.setBreakpoint || command.type === _type2.default.takeScreenshotOnFail;
}

function isExecutableInTopWindowOnly(command) {
    return command.type === _type2.default.testDone || command.type === _type2.default.switchToMainWindow || command.type === _type2.default.setNativeDialogHandler || command.type === _type2.default.getNativeDialogHistory || command.type === _type2.default.setTestSpeed || command.type === _type2.default.showAssertionRetriesStatus || command.type === _type2.default.hideAssertionRetriesStatus || command.type === _type2.default.setBreakpoint || isBrowserManipulationCommand(command) && command.type !== _type2.default.takeElementScreenshot;
}

function isJSExpression(val) {
    return val !== null && typeof val === 'object' && val.type === RAW_API_JS_EXPRESSION_TYPE && typeof val.value === 'string';
}

function isExecutableOnClientCommand(command) {
    return command.type !== _type2.default.wait && command.type !== _type2.default.setPageLoadTimeout && command.type !== _type2.default.debug && command.type !== _type2.default.useRole && command.type !== _type2.default.assertion && command.type !== _type2.default.executeExpression;
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy90ZXN0LXJ1bi9jb21tYW5kcy91dGlscy5qcyJdLCJuYW1lcyI6WyJpc0NvbW1hbmRSZWplY3RhYmxlQnlQYWdlRXJyb3IiLCJjYW5TZXREZWJ1Z2dlckJyZWFrcG9pbnRCZWZvcmVDb21tYW5kIiwiaXNTY3JlZW5zaG90Q29tbWFuZCIsImlzUmVzaXplV2luZG93Q29tbWFuZCIsImlzQnJvd3Nlck1hbmlwdWxhdGlvbkNvbW1hbmQiLCJpc1NlcnZpY2VDb21tYW5kIiwiaXNFeGVjdXRhYmxlSW5Ub3BXaW5kb3dPbmx5IiwiaXNKU0V4cHJlc3Npb24iLCJpc0V4ZWN1dGFibGVPbkNsaWVudENvbW1hbmQiLCJSQVdfQVBJX0pTX0VYUFJFU1NJT05fVFlQRSIsImNvbW1hbmQiLCJpc09ic2VydmF0aW9uQ29tbWFuZCIsImlzV2luZG93U3dpdGNoaW5nQ29tbWFuZCIsImlzQ2xpZW50RnVuY3Rpb25Db21tYW5kIiwidHlwZSIsIlRZUEUiLCJleGVjdXRlQ2xpZW50RnVuY3Rpb24iLCJleGVjdXRlU2VsZWN0b3IiLCJ3YWl0IiwiYXNzZXJ0aW9uIiwiZXhlY3V0ZUV4cHJlc3Npb24iLCJzd2l0Y2hUb0lmcmFtZSIsInN3aXRjaFRvTWFpbldpbmRvdyIsImRlYnVnIiwidGFrZVNjcmVlbnNob3QiLCJ0YWtlRWxlbWVudFNjcmVlbnNob3QiLCJ0YWtlU2NyZWVuc2hvdE9uRmFpbCIsInJlc2l6ZVdpbmRvdyIsInJlc2l6ZVdpbmRvd1RvRml0RGV2aWNlIiwibWF4aW1pemVXaW5kb3ciLCJ0ZXN0RG9uZSIsInNob3dBc3NlcnRpb25SZXRyaWVzU3RhdHVzIiwiaGlkZUFzc2VydGlvblJldHJpZXNTdGF0dXMiLCJzZXRCcmVha3BvaW50Iiwic2V0TmF0aXZlRGlhbG9nSGFuZGxlciIsImdldE5hdGl2ZURpYWxvZ0hpc3RvcnkiLCJzZXRUZXN0U3BlZWQiLCJ2YWwiLCJ2YWx1ZSIsInNldFBhZ2VMb2FkVGltZW91dCIsInVzZVJvbGUiXSwibWFw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SUFHQXhCLFFBQVFJLElBQVIsS0FBaUJDLGVBQUtvQixzQkFIdEIsSUFJQXpCLFFBQVFJLElBQVIsS0FBaUJDLGVBQUtxQixZQUp0QixJQUtBMUIsUUFBUUksSUFBUixLQUFpQkMsZUFBS2dCLDBCQUx0QixJQU1BckIsUUFBUUksSUFBUixLQUFpQkMsZUFBS2lCLDBCQU50QixJQU9BdEIsUUFBUUksSUFBUixLQUFpQkMsZUFBS2tCLGFBUHRCLElBUUE3Qiw2QkFBNkJNLE9BQTdCLEtBQXlDQSxRQUFRSSxJQUFSLEtBQWlCQyxlQUFLVSxxQkFSdEU7QUFTSDs7QUFFTSxTQUFTbEIsY0FBVCxDQUF5QjhCLEdBQXpCLEVBQThCO0FBQ2pDLFdBQU9BLFFBQVEsSUFBUixJQUFnQixPQUFPQSxHQUFQLEtBQWUsUUFBL0IsSUFBMkNBLElBQUl2QixJQUFKLEtBQWFMLDBCQUF4RCxJQUNBLE9BQU80QixJQUFJQyxLQUFYLEtBQXFCLFFBRDVCO0FBRUg7O0FBRU0sU0FBUzlCLDJCQUFULENBQXNDRSxPQUF0QyxFQUErQztBQUNsRCxXQUFPQSxRQUFRSSxJQUFSLEtBQWlCQyxlQUFLRyxJQUF0QixJQUNBUixRQUFRSSxJQUFSLEtBQWlCQyxlQUFLd0Isa0JBRHRCLElBRUE3QixRQUFRSSxJQUFSLEtBQWlCQyxlQUFLUSxLQUZ0QixJQUdBYixRQUFRSSxJQUFSLEtBQWlCQyxlQUFLeUIsT0FIdEIsSUFJQTlCLFFBQVFJLElBQVIsS0FBaUJDLGVBQUtJLFNBSnRCLElBS0FULFFBQVFJLElBQVIsS0FBaUJDLGVBQUtLLGlCQUw3QjtBQU1IIiwiZmlsZSI6InRlc3QtcnVuL2NvbW1hbmRzL3V0aWxzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gV0FSTklORzogdGhpcyBmaWxlIGlzIHVzZWQgYnkgYm90aCB0aGUgY2xpZW50IGFuZCB0aGUgc2VydmVyLlxuLy8gRG8gbm90IHVzZSBhbnkgYnJvd3NlciBvciBub2RlLXNwZWNpZmljIEFQSSFcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmltcG9ydCBUWVBFIGZyb20gJy4vdHlwZSc7XG5cbmNvbnN0IFJBV19BUElfSlNfRVhQUkVTU0lPTl9UWVBFID0gJ2pzLWV4cHInO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNDb21tYW5kUmVqZWN0YWJsZUJ5UGFnZUVycm9yIChjb21tYW5kKSB7XG4gICAgcmV0dXJuICFpc09ic2VydmF0aW9uQ29tbWFuZChjb21tYW5kKSAmJiAhaXNCcm93c2VyTWFuaXB1bGF0aW9uQ29tbWFuZChjb21tYW5kKSAmJiAhaXNTZXJ2aWNlQ29tbWFuZChjb21tYW5kKSB8fFxuICAgICAgICAgICBpc1Jlc2l6ZVdpbmRvd0NvbW1hbmQoY29tbWFuZClcbiAgICAgICAgICAgJiYgIWlzV2luZG93U3dpdGNoaW5nQ29tbWFuZChjb21tYW5kKTtcbn1cblxuZnVuY3Rpb24gaXNDbGllbnRGdW5jdGlvbkNvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gY29tbWFuZC50eXBlID09PSBUWVBFLmV4ZWN1dGVDbGllbnRGdW5jdGlvbiB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuZXhlY3V0ZVNlbGVjdG9yO1xufVxuXG5mdW5jdGlvbiBpc09ic2VydmF0aW9uQ29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBpc0NsaWVudEZ1bmN0aW9uQ29tbWFuZChjb21tYW5kKSB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUud2FpdCB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuYXNzZXJ0aW9uIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5leGVjdXRlRXhwcmVzc2lvbjtcbn1cblxuZnVuY3Rpb24gaXNXaW5kb3dTd2l0Y2hpbmdDb21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zd2l0Y2hUb0lmcmFtZSB8fCBjb21tYW5kLnR5cGUgPT09IFRZUEUuc3dpdGNoVG9NYWluV2luZG93O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FuU2V0RGVidWdnZXJCcmVha3BvaW50QmVmb3JlQ29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBjb21tYW5kLnR5cGUgIT09IFRZUEUuZGVidWcgJiYgIWlzQ2xpZW50RnVuY3Rpb25Db21tYW5kKGNvbW1hbmQpICYmICFpc1NlcnZpY2VDb21tYW5kKGNvbW1hbmQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTY3JlZW5zaG90Q29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBjb21tYW5kLnR5cGUgPT09IFRZUEUudGFrZVNjcmVlbnNob3QgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnRha2VFbGVtZW50U2NyZWVuc2hvdCB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUudGFrZVNjcmVlbnNob3RPbkZhaWw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1Jlc2l6ZVdpbmRvd0NvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gY29tbWFuZC50eXBlID09PSBUWVBFLnJlc2l6ZVdpbmRvdyB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUucmVzaXplV2luZG93VG9GaXREZXZpY2UgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLm1heGltaXplV2luZG93O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNCcm93c2VyTWFuaXB1bGF0aW9uQ29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBpc1NjcmVlbnNob3RDb21tYW5kKGNvbW1hbmQpIHx8IGlzUmVzaXplV2luZG93Q29tbWFuZChjb21tYW5kKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2VydmljZUNvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gY29tbWFuZC50eXBlID09PSBUWVBFLnRlc3REb25lIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zaG93QXNzZXJ0aW9uUmV0cmllc1N0YXR1cyB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuaGlkZUFzc2VydGlvblJldHJpZXNTdGF0dXMgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnNldEJyZWFrcG9pbnQgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnRha2VTY3JlZW5zaG90T25GYWlsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFeGVjdXRhYmxlSW5Ub3BXaW5kb3dPbmx5IChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS50ZXN0RG9uZSB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuc3dpdGNoVG9NYWluV2luZG93IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zZXROYXRpdmVEaWFsb2dIYW5kbGVyIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5nZXROYXRpdmVEaWFsb2dIaXN0b3J5IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zZXRUZXN0U3BlZWQgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnNob3dBc3NlcnRpb25SZXRyaWVzU3RhdHVzIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5oaWRlQXNzZXJ0aW9uUmV0cmllc1N0YXR1cyB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuc2V0QnJlYWtwb2ludCB8fFxuICAgICAgICAgICBpc0Jyb3dzZXJNYW5pcHVsYXRpb25Db21tYW5kKGNvbW1hbmQpICYmIGNvbW1hbmQudHlwZSAhPT0gVFlQRS50YWtlRWxlbWVudFNjcmVlbnNob3Q7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0pTRXhwcmVzc2lvbiAodmFsKSB7XG4gICAgcmV0dXJuIHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0JyAmJiB2YWwudHlwZSA9PT0gUkFXX0FQSV9KU19FWFBSRVNTSU9OX1RZUEUgJiZcbiAgICAgICAgICAgdHlwZW9mIHZhbC52YWx1ZSA9PT0gJ3N0cmluZyc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0V4ZWN1dGFibGVPbkNsaWVudENvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gY29tbWFuZC50eXBlICE9PSBUWVBFLndhaXQgJiZcbiAgICAgICAgICAgY29tbWFuZC50eXBlICE9PSBUWVBFLnNldFBhZ2VMb2FkVGltZW91dCAmJlxuICAgICAgICAgICBjb21tYW5kLnR5cGUgIT09IFRZUEUuZGVidWcgJiZcbiAgICAgICAgICAgY29tbWFuZC50eXBlICE9PSBUWVBFLnVzZVJvbGUgJiZcbiAgICAgICAgICAgY29tbWFuZC50eXBlICE9PSBUWVBFLmFzc2VydGlvbiAmJlxuICAgICAgICAgICBjb21tYW5kLnR5cGUgIT09IFRZUEUuZXhlY3V0ZUV4cHJlc3Npb247XG59XG4iXX0=
